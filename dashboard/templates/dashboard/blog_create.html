{% extends 'dashboard/base.html' %}
{% load static %}

{% block title %}Ø§ÛŒØ¬Ø§Ø¯ Ù…Ù‚Ø§Ù„Ù‡ Ø¬Ø¯ÛŒØ¯ | Mobix{% endblock %}

{% block content %}
<div class="space-y-6 fade-in">
    <!-- Ù‡Ø¯Ø± ØµÙØ­Ù‡ -->
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
        <div>
            <div class="flex items-center gap-3">
                <a href="{% url 'blog_list' %}" 
                   class="text-gray-500 hover:text-gray-700 transition">
                    <i class="ti ti-arrow-right text-xl"></i>
                </a>
                <div>
                    <h1 class="text-2xl font-bold text-gray-900">ğŸ“ Ø§ÛŒØ¬Ø§Ø¯ Ù…Ù‚Ø§Ù„Ù‡ Ø¬Ø¯ÛŒØ¯</h1>
                    <p class="text-gray-600 mt-1">Ù†ÙˆØ´ØªÙ† Ùˆ Ø§Ù†ØªØ´Ø§Ø± Ù…Ù‚Ø§Ù„Ù‡ Ø¯Ø± ÙˆØ¨Ù„Ø§Ú¯</p>
                </div>
            </div>
        </div>
        
        <!-- Ø±Ø§Ù‡Ù†Ù…Ø§ -->
        <div class="flex items-center gap-2 text-blue-600">
            <i class="ti ti-info-circle"></i>
            <span class="text-sm">Ù…Ù‚Ø§Ù„Ø§Øª Ù¾Ø³ Ø§Ø² ØªØ£ÛŒÛŒØ¯ Ø¯Ø± Ø³Ø§ÛŒØª Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯</span>
        </div>
    </div>
    
    <!-- ÙØ±Ù… Ø§ØµÙ„ÛŒ Ø¯Ø± Ø¯Ùˆ Ø³ØªÙˆÙ† -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Ø³ØªÙˆÙ† Ú†Ù¾: ÙØ±Ù… Ù…Ù‚Ø§Ù„Ù‡ -->
        <div class="lg:col-span-2">
            <div class="bg-white rounded-2xl shadow-lg border border-gray-200 p-6">
                <h2 class="text-xl font-bold text-gray-900 mb-6 pb-4 border-b border-gray-200">
                    Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡
                </h2>
                
                <!-- Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø®Ø·Ø§ -->
                {% if messages %}
                <div class="mb-6 space-y-3">
                    {% for message in messages %}
                    <div class="p-4 rounded-xl {% if message.tags == 'success' %}bg-green-100 text-green-800{% else %}bg-red-100 text-red-800{% endif %} border">
                        <div class="flex items-center">
                            <i class="ti {% if message.tags == 'success' %}ti-check{% else %}ti-alert-circle{% endif %} ml-2"></i>
                            {{ message }}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                
                <!-- ÙØ±Ù… Ø§ÛŒØ¬Ø§Ø¯ Ù…Ù‚Ø§Ù„Ù‡ -->
                <form method="POST" id="createArticleForm" class="space-y-6" enctype="multipart/form-data">
                    {% csrf_token %}
                    
                    <!-- Ø¨Ø®Ø´ Û±: Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§ØµÙ„ÛŒ -->
                    <div class="border border-gray-200 rounded-2xl p-5">
                        <h3 class="font-bold text-lg text-gray-800 mb-4 flex items-center">
                            <div class="w-8 h-8 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center ml-3">
                                <i class="ti ti-news"></i>
                            </div>
                            Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§ØµÙ„ÛŒ Ù…Ù‚Ø§Ù„Ù‡
                        </h3>
                        
                        <!-- Ø¹Ù†ÙˆØ§Ù† Ù…Ù‚Ø§Ù„Ù‡ -->
                        <div class="mb-6">
                            <label class="block text-gray-700 mb-2 font-medium">
                                Ø¹Ù†ÙˆØ§Ù† Ù…Ù‚Ø§Ù„Ù‡
                                <span class="text-red-500">*</span>
                            </label>
                            <input type="text" 
                                   name="title" 
                                   id="title"
                                   required
                                   class="w-full bg-gray-50 border border-gray-300 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                                   placeholder="ÛŒÚ© Ø¹Ù†ÙˆØ§Ù† Ø¬Ø°Ø§Ø¨ Ùˆ ØªÙˆØµÛŒÙÛŒ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯"
                                   maxlength="200">
                            <p class="text-gray-500 text-xs mt-2">Ø­Ø¯Ø§Ú©Ø«Ø± Û²Û°Û° Ú©Ø§Ø±Ø§Ú©ØªØ±</p>
                        </div>
                        
                        <!-- Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ -->
                        <div class="mb-6">
                            <label class="block text-gray-700 mb-2 font-medium">
                                Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ
                                <span class="text-red-500">*</span>
                            </label>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                {% for code, name in category_choices %}
                                <label class="flex items-center p-3 border border-gray-300 rounded-xl hover:bg-gray-50 cursor-pointer transition">
                                    <input type="radio" 
                                           name="category" 
                                           value="{{ code }}"
                                           required
                                           class="w-5 h-5 text-blue-600 border-gray-300 focus:ring-blue-500"
                                           {% if forloop.first %}checked{% endif %}>
                                    <span class="mr-2 text-gray-700">{{ name }}</span>
                                </label>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ø¨Ø®Ø´ Û²: Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ -->
                    <div class="border border-gray-200 rounded-2xl p-5">
                        <h3 class="font-bold text-lg text-gray-800 mb-4 flex items-center">
                            <div class="w-8 h-8 bg-green-100 text-green-600 rounded-lg flex items-center justify-center ml-3">
                                <i class="ti ti-file-text"></i>
                            </div>
                            Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡
                            <span class="text-red-500 mr-2">*</span>
                        </h3>
                        
                        <!-- ÙˆÛŒØ±Ø§ÛŒØ´Ú¯Ø± Ù…ØªÙ† -->
                        <div>
                            <label class="block text-gray-700 mb-2 font-medium">Ù…ØªÙ† Ù…Ù‚Ø§Ù„Ù‡</label>
                            <textarea name="content" 
                                      id="content"
                                      rows="12"
                                      required
                                      class="w-full bg-gray-50 border border-gray-300 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                                      placeholder="Ù…Ø­ØªÙˆØ§ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯..."></textarea>
                            
                            <!-- Ù†Ú©Ø§Øª Ù†Ú¯Ø§Ø±Ø´ÛŒ -->
                            <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-xl">
                                <h4 class="font-bold text-blue-800 mb-2">Ù†Ú©Ø§Øª Ù†Ú¯Ø§Ø±Ø´ÛŒ:</h4>
                                <ul class="text-blue-700 text-sm space-y-1">
                                    <li>â€¢ Ø§Ø² Ù¾Ø§Ø±Ø§Ú¯Ø±Ø§Ùâ€ŒÙ‡Ø§ÛŒ Ú©ÙˆØªØ§Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                                    <li>â€¢ Ø¹Ù†Ø§ÙˆÛŒÙ† ÙØ±Ø¹ÛŒ Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø²Ù…Ø§Ù†Ø¯Ù‡ÛŒ Ù…ØªÙ† Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯</li>
                                    <li>â€¢ Ø§Ø² ØªØµØ§ÙˆÛŒØ± Ù…Ø±ØªØ¨Ø· Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                                    <li>â€¢ Ù…Ù‚Ø¯Ù…Ù‡ Ùˆ Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ø¨Ø®Ø´ Û³: ØªØµÙˆÛŒØ± Ù…Ù‚Ø§Ù„Ù‡ -->
                    <div class="border border-gray-200 rounded-2xl p-5">
                        <h3 class="font-bold text-lg text-gray-800 mb-4 flex items-center">
                            <div class="w-8 h-8 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center ml-3">
                                <i class="ti ti-photo"></i>
                            </div>
                            ØªØµÙˆÛŒØ± Ø´Ø§Ø®Øµ Ù…Ù‚Ø§Ù„Ù‡ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
                        </h3>
                        
                        <!-- Ø¢Ù¾Ù„ÙˆØ¯ ØªØµÙˆÛŒØ± -->
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2 font-medium">Ø§Ù†ØªØ®Ø§Ø¨ ØªØµÙˆÛŒØ±</label>
                            <div class="flex items-center justify-center w-full">
                                <label for="image" class="flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-2xl cursor-pointer bg-gray-50 hover:bg-gray-100 transition">
                                    <div class="flex flex-col items-center justify-center pt-5 pb-6">
                                        <i class="ti ti-upload text-4xl text-gray-400 mb-4"></i>
                                        <p class="mb-2 text-sm text-gray-500">
                                            <span class="font-semibold">Ø¨Ø±Ø§ÛŒ Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯</span>
                                        </p>
                                        <p class="text-xs text-gray-500">PNG, JPG ÛŒØ§ JPEG (Ø­Ø¯Ø§Ú©Ø«Ø± ÛµMB)</p>
                                    </div>
                                    <input id="image" name="image" type="file" class="hidden" accept="image/*">
                                </label>
                            </div>
                        </div>
                        
                        <!-- Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ ØªØµÙˆÛŒØ± -->
                        <div id="imagePreview" class="hidden mt-4">
                            <label class="block text-gray-700 mb-2 font-medium">Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ ØªØµÙˆÛŒØ±</label>
                            <div class="w-full max-w-md mx-auto">
                                <img id="previewImage" class="w-full h-48 object-cover rounded-xl border border-gray-300">
                                <button type="button" 
                                        onclick="removeImage()"
                                        class="mt-2 text-red-600 hover:text-red-800 text-sm">
                                    <i class="ti ti-trash ml-1"></i>
                                    Ø­Ø°Ù ØªØµÙˆÛŒØ±
                                </button>
                            </div>
                        </div>
                        
                        <!-- Ù†Ú©Ø§Øª ØªØµÙˆÛŒØ± -->
                        <div class="mt-4 p-3 bg-amber-50 border border-amber-200 rounded-xl">
                            <h4 class="font-bold text-amber-800 mb-2">Ù†Ú©Ø§Øª ØªØµÙˆÛŒØ±:</h4>
                            <ul class="text-amber-700 text-sm space-y-1">
                                <li>â€¢ Ø³Ø§ÛŒØ² Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ: Û±Û²Û°Û° Ã— Û¶Û°Û° Ù¾ÛŒÚ©Ø³Ù„</li>
                                <li>â€¢ ÙØ±Ù…Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø¬Ø§Ø²: JPG, PNG, WebP</li>
                                <li>â€¢ Ø­Ø¬Ù… ØªØµÙˆÛŒØ±: Ø­Ø¯Ø§Ú©Ø«Ø± Ûµ Ù…Ú¯Ø§Ø¨Ø§ÛŒØª</li>
                                <li>â€¢ Ø§Ø² ØªØµØ§ÙˆÛŒØ± Ø¨Ø§ Ú©ÛŒÙÛŒØª Ùˆ Ù…Ø±ØªØ¨Ø· Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                            </ul>
                        </div>
                    </div>
                    
                    <!-- Ø¨Ø®Ø´ Û´: ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ù†ØªØ´Ø§Ø± -->
                    <div class="border border-gray-200 rounded-2xl p-5">
                        <h3 class="font-bold text-lg text-gray-800 mb-4 flex items-center">
                            <div class="w-8 h-8 bg-amber-100 text-amber-600 rounded-lg flex items-center justify-center ml-3">
                                <i class="ti ti-calendar"></i>
                            </div>
                            ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ù†ØªØ´Ø§Ø±
                        </h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ´Ø§Ø± -->
                            <div>
                                <label class="block text-gray-700 mb-2 font-medium">ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ´Ø§Ø±</label>
                                <input type="datetime-local" 
                                       name="publish_date"
                                       id="publish_date"
                                       class="w-full bg-gray-50 border border-gray-300 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                                       dir="ltr">
                                <p class="text-gray-500 text-xs mt-2">Ø¯Ø± ØµÙˆØ±Øª Ø®Ø§Ù„ÛŒ Ø¨ÙˆØ¯Ù†ØŒ Ø²Ù…Ø§Ù† ÙØ¹Ù„ÛŒ Ø¯Ø± Ù†Ø¸Ø± Ú¯Ø±ÙØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</p>
                            </div>
                            
                            <!-- ÙˆØ¶Ø¹ÛŒØª Ù…Ù‚Ø§Ù„Ù‡ -->
                            <div>
                                <label class="block text-gray-700 mb-2 font-medium">ÙˆØ¶Ø¹ÛŒØª Ù…Ù‚Ø§Ù„Ù‡</label>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="radio" 
                                               name="status" 
                                               value="draft"
                                               checked
                                               class="w-5 h-5 text-blue-600 border-gray-300 focus:ring-blue-500">
                                        <span class="mr-2 text-gray-700">Ù¾ÛŒØ´â€ŒÙ†ÙˆÛŒØ³</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" 
                                               name="status" 
                                               value="published"
                                               class="w-5 h-5 text-blue-600 border-gray-300 focus:ring-blue-500">
                                        <span class="mr-2 text-gray-700">Ù…Ù†ØªØ´Ø± Ø´Ø¯Ù‡</span>
                                    </label>
                                </div>
                                <p class="text-gray-500 text-xs mt-2">Ù…Ù‚Ø§Ù„Ø§Øª Ù…Ù†ØªØ´Ø± Ø´Ø¯Ù‡ Ø¨Ù„Ø§ÙØ§ØµÙ„Ù‡ Ø¯Ø± Ø³Ø§ÛŒØª Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ù‚Ø¯Ø§Ù… -->
                    <div class="flex flex-col sm:flex-row justify-between items-center gap-4 pt-6 border-t border-gray-200">
                        <!-- Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ø²Ú¯Ø´Øª -->
                        <a href="{% url 'blog_list' %}" 
                           class="order-2 sm:order-1 w-full sm:w-auto px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition text-center">
                            <i class="ti ti-arrow-right ml-2"></i>
                            Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù„ÛŒØ³Øª Ù…Ù‚Ø§Ù„Ø§Øª
                        </a>
                        
                        <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ -->
                        <div class="order-1 sm:order-2 flex flex-col sm:flex-row gap-3 w-full sm:w-auto">
                            <!-- Ø°Ø®ÛŒØ±Ù‡ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ù¾ÛŒØ´â€ŒÙ†ÙˆÛŒØ³ -->
                            <button type="submit" 
                                    name="save_draft"
                                    class="w-full sm:w-auto px-6 py-3 bg-amber-600 hover:bg-amber-700 text-white rounded-xl transition">
                                <i class="ti ti-device-floppy ml-2"></i>
                                Ø°Ø®ÛŒØ±Ù‡ Ù¾ÛŒØ´â€ŒÙ†ÙˆÛŒØ³
                            </button>
                            
                            <!-- Ø°Ø®ÛŒØ±Ù‡ Ùˆ Ø§Ù†ØªØ´Ø§Ø± -->
                            <button type="submit" 
                                    name="save_publish"
                                    class="w-full sm:w-auto px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl transition">
                                <i class="ti ti-send ml-2"></i>
                                Ø§Ù†ØªØ´Ø§Ø± Ù…Ù‚Ø§Ù„Ù‡
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Ø³ØªÙˆÙ† Ø±Ø§Ø³Øª: Ø±Ø§Ù‡Ù†Ù…Ø§ Ùˆ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ -->
        <div class="space-y-6">
            <!-- Ú©Ø§Ø±Øª Ø±Ø§Ù‡Ù†Ù…Ø§ -->
            <div class="bg-white rounded-2xl shadow-lg border border-gray-200 p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-4">Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ù†ÙˆØ´ØªÙ† Ù…Ù‚Ø§Ù„Ù‡</h3>
                <ul class="space-y-3">
                    <li class="flex items-start">
                        <i class="ti ti-news text-blue-500 ml-2 mt-1"></i>
                        <span class="text-gray-700">Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§ÛŒØ¯ Ø¬Ø°Ø§Ø¨ØŒ Ù…Ø®ØªØµØ± Ùˆ ØªÙˆØµÛŒÙÛŒ Ø¨Ø§Ø´Ø¯.</span>
                    </li>
                    <li class="flex items-start">
                        <i class="ti ti-category text-green-500 ml-2 mt-1"></i>
                        <span class="text-gray-700">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ù†Ø§Ø³Ø¨ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.</span>
                    </li>
                    <li class="flex items-start">
                        <i class="ti ti-photo text-purple-500 ml-2 mt-1"></i>
                        <span class="text-gray-700">ØªØµÙˆÛŒØ± Ø´Ø§Ø®Øµ Ú©ÛŒÙÛŒØª Ù…Ù‚Ø§Ù„Ù‡ Ø±Ø§ Ø§ÙØ²Ø§ÛŒØ´ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.</span>
                    </li>
                    <li class="flex items-start">
                        <i class="ti ti-checklist text-amber-500 ml-2 mt-1"></i>
                        <span class="text-gray-700">Ù¾ÛŒØ´ Ø§Ø² Ø§Ù†ØªØ´Ø§Ø±ØŒ Ù…Ù‚Ø§Ù„Ù‡ Ø±Ø§ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯.</span>
                    </li>
                </ul>
                
                <!-- Ù†Ú©Ø§Øª SEO -->
                <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-xl">
                    <h4 class="font-bold text-blue-800 mb-2">Ù†Ú©Ø§Øª SEO:</h4>
                    <ul class="text-blue-700 text-sm space-y-2">
                        <li>â€¢ Ø§Ø² Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ Ø¯Ø± Ø¹Ù†ÙˆØ§Ù† Ùˆ Ù…ØªÙ† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                        <li>â€¢ Ù…ØªØ§ Ø¯ÛŒØ³Ú©Ø±ÛŒÙ¾Ø´Ù† Ù…Ù†Ø§Ø³Ø¨ÛŒ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯</li>
                        <li>â€¢ Ø§Ø² ØªÚ¯â€ŒÙ‡Ø§ÛŒ Ù‡Ø¯ÛŒÙ†Ú¯ (H2, H3) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
                        <li>â€¢ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ÛŒ Ùˆ Ø®Ø§Ø±Ø¬ÛŒ Ù…Ø±ØªØ¨Ø· Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯</li>
                    </ul>
                </div>
            </div>
            
            <!-- Ú©Ø§Ø±Øª Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ -->
            <div class="bg-white rounded-2xl shadow-lg border border-gray-200 p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-4">Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ù…Ù‚Ø§Ù„Ù‡</h3>
                
                <div class="text-center p-4 border-2 border-dashed border-gray-300 rounded-xl">
                    <!-- ØªØµÙˆÛŒØ± Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ -->
                    <div id="cardImagePreview" class="w-full h-40 bg-gradient-to-r from-blue-100 to-purple-100 rounded-xl mb-4 flex items-center justify-center">
                        <i class="ti ti-news text-3xl text-blue-600"></i>
                    </div>
                    
                    <!-- Ø¹Ù†ÙˆØ§Ù† -->
                    <div id="previewTitle" class="text-xl font-bold text-gray-800 mb-2 line-clamp-2">
                        [Ø¹Ù†ÙˆØ§Ù† Ù…Ù‚Ø§Ù„Ù‡ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯]
                    </div>
                    
                    <!-- Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ -->
                    <div class="mb-4">
                        <span id="previewCategory" class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800">
                            <i class="ti ti-tag text-xs ml-1"></i>
                            Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ
                        </span>
                    </div>
                    
                    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª -->
                    <div class="grid grid-cols-2 gap-3 text-sm">
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <div class="text-gray-500">ÙˆØ¶Ø¹ÛŒØª</div>
                            <div id="previewStatus" class="font-medium text-amber-600">Ù¾ÛŒØ´â€ŒÙ†ÙˆÛŒØ³</div>
                        </div>
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <div class="text-gray-500">ØªØ§Ø±ÛŒØ®</div>
                            <div id="previewDate" class="font-medium">Ù‡Ù…ÛŒÙ† Ø­Ø§Ù„Ø§</div>
                        </div>
                    </div>
                    
                    <div class="mt-4 text-xs text-gray-500">
                        <i class="ti ti-clock ml-1"></i>
                        Ø§ÛŒØ¬Ø§Ø¯: Ù‡Ù…ÛŒÙ† Ø­Ø§Ù„Ø§
                    </div>
                </div>
                
                <!-- Ø¯Ú©Ù…Ù‡ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ú©Ø§Ù…Ù„ -->
                {% comment %} <button type="button" 
                        onclick="previewArticle()"
                        class="w-full mt-4 px-4 py-2.5 border-2 border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition">
                    <i class="ti ti-eye ml-2"></i>
                    Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ú©Ø§Ù…Ù„
                </button> {% endcomment %}
            </div>
            
            <!-- Ú©Ø§Ø±Øª Ø¢Ù…Ø§Ø± -->
            <div class="bg-white rounded-2xl shadow-lg border border-gray-200 p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-4">Ø¢Ù…Ø§Ø± Ù†ÙˆØ´ØªÙ†</h3>
                
                <div class="space-y-4">
                    <!-- ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª -->
                    <div>
                        <div class="flex justify-between text-sm text-gray-600 mb-1">
                            <span>ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª</span>
                            <span id="wordCount">0</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div id="wordCountBar" class="bg-blue-600 h-2 rounded-full" style="width: 0%"></div>
                        </div>
                        <p class="text-gray-500 text-xs mt-2">Ù…Ù‚Ø§Ù„Ø§Øª Ø®ÙˆØ¨ Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ Ø¨ÛŒÙ† Û¸Û°Û° ØªØ§ Û±ÛµÛ°Û° Ú©Ù„Ù…Ù‡ Ù‡Ø³ØªÙ†Ø¯.</p>
                    </div>
                    
                    <!-- Ø²Ù…Ø§Ù† ØªØ®Ù…ÛŒÙ†ÛŒ Ù…Ø·Ø§Ù„Ø¹Ù‡ -->
                    <div>
                        <div class="flex justify-between text-sm text-gray-600 mb-1">
                            <span>Ø²Ù…Ø§Ù† Ù…Ø·Ø§Ù„Ø¹Ù‡</span>
                            <span id="readTime">Û° Ø¯Ù‚ÛŒÙ‚Ù‡</span>
                        </div>
                        <div class="flex items-center text-gray-500 text-xs">
                            <i class="ti ti-clock ml-1"></i>
                            <span>Ø²Ù…Ø§Ù† ØªØ®Ù…ÛŒÙ†ÛŒ Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù† Ù…Ù‚Ø§Ù„Ù‡</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ -->
<script>
// ==================== Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ ØªØµÙˆÛŒØ± ====================
document.getElementById('image').addEventListener('change', function(event) {
    const file = event.target.files[0];
    const preview = document.getElementById('imagePreview');
    const imgPreview = document.getElementById('previewImage');
    const cardPreview = document.getElementById('cardImagePreview');
    
    if (file) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
            imgPreview.src = e.target.result;
            preview.classList.remove('hidden');
            
            // Ø¢Ù¾Ø¯ÛŒØª ØªØµÙˆÛŒØ± Ø¯Ø± Ú©Ø§Ø±Øª Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´
            cardPreview.innerHTML = `<img src="${e.target.result}" class="w-full h-full object-cover rounded-xl">`;
        }
        
        reader.readAsDataURL(file);
    }
});

function removeImage() {
    document.getElementById('image').value = '';
    document.getElementById('imagePreview').classList.add('hidden');
    document.getElementById('cardImagePreview').innerHTML = '<i class="ti ti-news text-3xl text-blue-600"></i>';
}

// ==================== Ø´Ù…Ø§Ø±Ø´ Ú©Ù„Ù…Ø§Øª ====================
function countWords(text) {
    return text.trim().split(/\s+/).filter(word => word.length > 0).length;
}

function updateWordCount() {
    const content = document.getElementById('content').value;
    const wordCount = countWords(content);
    const wordCountElement = document.getElementById('wordCount');
    const wordCountBar = document.getElementById('wordCountBar');
    const readTimeElement = document.getElementById('readTime');
    
    // Ù†Ù…Ø§ÛŒØ´ ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª
    wordCountElement.textContent = wordCount;
    
    // Ø¢Ù¾Ø¯ÛŒØª Ù†ÙˆØ§Ø± Ù¾ÛŒØ´Ø±ÙØª
    const percentage = Math.min((wordCount / 2000) * 100, 100);
    wordCountBar.style.width = percentage + '%';
    
    // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø²Ù…Ø§Ù† Ù…Ø·Ø§Ù„Ø¹Ù‡
    const readTimeMinutes = Math.ceil(wordCount / 200); // ÙØ±Ø¶: 200 Ú©Ù„Ù…Ù‡ Ø¯Ø± Ø¯Ù‚ÛŒÙ‚Ù‡
    readTimeElement.textContent = readTimeMinutes + ' Ø¯Ù‚ÛŒÙ‚Ù‡';
    
    // ØªØºÛŒÛŒØ± Ø±Ù†Ú¯ Ù†ÙˆØ§Ø± Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª
    if (wordCount < 300) {
        wordCountBar.className = 'bg-red-500 h-2 rounded-full';
    } else if (wordCount < 800) {
        wordCountBar.className = 'bg-amber-500 h-2 rounded-full';
    } else {
        wordCountBar.className = 'bg-green-500 h-2 rounded-full';
    }
}

// ==================== Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ ====================
function updatePreview() {
    // Ø¹Ù†ÙˆØ§Ù†
    const title = document.getElementById('title').value;
    document.getElementById('previewTitle').textContent = title || '[Ø¹Ù†ÙˆØ§Ù† Ù…Ù‚Ø§Ù„Ù‡ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯]';
    
    // Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ
    const category = document.querySelector('input[name="category"]:checked');
    if (category) {
        const categoryNames = {
            'tech': 'ØªÚ©Ù†ÙˆÙ„ÙˆÚ˜ÛŒ Ùˆ Ú©Ø§Ù„Ø§ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„',
            'game': 'Ø¨Ø§Ø²ÛŒ Ùˆ Ø³Ø±Ú¯Ø±Ù…ÛŒ',
            'edu': 'Ø¢Ù…ÙˆØ²Ø´'
        };
        document.getElementById('previewCategory').innerHTML = `
            <i class="ti ti-tag text-xs ml-1"></i>
            ${categoryNames[category.value] || 'Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ'}
        `;
    }
    
    // ÙˆØ¶Ø¹ÛŒØª
    const status = document.querySelector('input[name="status"]:checked');
    const statusElement = document.getElementById('previewStatus');
    if (status) {
        if (status.value === 'published') {
            statusElement.textContent = 'Ù…Ù†ØªØ´Ø± Ø´Ø¯Ù‡';
            statusElement.className = 'font-medium text-green-600';
        } else {
            statusElement.textContent = 'Ù¾ÛŒØ´â€ŒÙ†ÙˆÛŒØ³';
            statusElement.className = 'font-medium text-amber-600';
        }
    }
    
    // ØªØ§Ø±ÛŒØ®
    const dateInput = document.getElementById('publish_date').value;
    const dateElement = document.getElementById('previewDate');
    if (dateInput) {
        const date = new Date(dateInput);
        const options = { year: 'numeric', month: 'long', day: 'numeric' };
        dateElement.textContent = date.toLocaleDateString('fa-IR', options);
    } else {
        dateElement.textContent = 'Ù‡Ù…ÛŒÙ† Ø­Ø§Ù„Ø§';
    }
    
    // Ø¢Ù¾Ø¯ÛŒØª ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª
    updateWordCount();
}

// ==================== Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ú©Ø§Ù…Ù„ Ù…Ù‚Ø§Ù„Ù‡ ====================
{% comment %} function previewArticle() {
    const title = document.getElementById('title').value;
    const content = document.getElementById('content').value;
    
    if (!title || !content) {
        alert('Ù„Ø·ÙØ§Ù‹ Ø¹Ù†ÙˆØ§Ù† Ùˆ Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
        return;
    }
    
    // Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù† ÛŒÚ© Ù…ÙˆØ¯Ø§Ù„ ÛŒØ§ ØµÙØ­Ù‡ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¨Ø§Ø² Ú©Ø±Ø¯
    alert('Ù…Ù‚Ø§Ù„Ù‡ Ø´Ù…Ø§ Ø¢Ù…Ø§Ø¯Ù‡ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø§Ø³Øª!\n\nØ¹Ù†ÙˆØ§Ù†: ' + title + '\n\nÙ…Ø­ØªÙˆØ§ÛŒ Ø´Ù…Ø§ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯.');
} {% endcomment %}

// ==================== ØªÙ†Ø¸ÛŒÙ… ØªØ§Ø±ÛŒØ® Ù¾ÛŒØ´â€ŒÙØ±Ø¶ ====================
function setDefaultDateTime() {
    const now = new Date();
    const timezoneOffset = now.getTimezoneOffset() * 60000; // offset in milliseconds
    const localISOTime = new Date(now - timezoneOffset).toISOString().slice(0, 16);
    document.getElementById('publish_date').value = localISOTime;
}

// ==================== Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙØ±Ù… ====================
function validateForm(event) {
    const title = document.getElementById('title').value.trim();
    const content = document.getElementById('content').value.trim();
    const category = document.querySelector('input[name="category"]:checked');
    
    if (!title) {
        alert('Ù„Ø·ÙØ§Ù‹ Ø¹Ù†ÙˆØ§Ù† Ù…Ù‚Ø§Ù„Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
        event.preventDefault();
        return false;
    }
    
    if (!content) {
        alert('Ù„Ø·ÙØ§Ù‹ Ù…Ø­ØªÙˆØ§ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
        event.preventDefault();
        return false;
    }
    
    if (!category) {
        alert('Ù„Ø·ÙØ§Ù‹ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ù‚Ø§Ù„Ù‡ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.');
        event.preventDefault();
        return false;
    }
    
    // Ø¨Ø±Ø±Ø³ÛŒ ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª
    const wordCount = countWords(content);
    if (wordCount < 100) {
        const confirmShort = confirm(`Ù…Ù‚Ø§Ù„Ù‡ Ø´Ù…Ø§ ÙÙ‚Ø· ${wordCount} Ú©Ù„Ù…Ù‡ Ø¯Ø§Ø±Ø¯. Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ù‡ÛŒØ¯ØŸ`);
        if (!confirmShort) {
            event.preventDefault();
            return false;
        }
    }
    
    return true;
}

// ==================== Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ ØªØºÛŒÛŒØ± ====================
document.addEventListener('DOMContentLoaded', function() {
    // ØªÙ†Ø¸ÛŒÙ… ØªØ§Ø±ÛŒØ® Ù¾ÛŒØ´â€ŒÙØ±Ø¶
    setDefaultDateTime();
    
    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¨Ø§ ØªØºÛŒÛŒØ± ÙØ±Ù…
    const formInputs = document.querySelectorAll('input, textarea, select');
    formInputs.forEach(input => {
        input.addEventListener('input', updatePreview);
        input.addEventListener('change', updatePreview);
    });
    
    // Ø´Ù…Ø§Ø±Ø´ Ú©Ù„Ù…Ø§Øª
    document.getElementById('content').addEventListener('input', updateWordCount);
    
    // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´
    updatePreview();
    
    // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙØ±Ù…
    document.getElementById('createArticleForm').addEventListener('submit', validateForm);
});
</script>

<style>
/* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ */
.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.fade-in {
    animation: fadeInUp 0.5s ease-out;
}
</style>
{% endblock %}